<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PyCallGraph Explorations &mdash; The Ape 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="The Ape 0.0.1 documentation" href="../../../../index.html" />
    <link rel="up" title="Call Graphs" href="index.html" />
    <link rel="next" title="Exploring Importlib" href="../explore_importlib/index.html" />
    <link rel="prev" title="ape.components.component.Composite" href="api/ape.components.component.Composite.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../explore_importlib/index.html" title="Exploring Importlib"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api/ape.components.component.Composite.html" title="ape.components.component.Composite"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../../index.html">Ape Documentation</a> &raquo;</li>
          <li><a href="../../index.html" >The Ape Developer Documentation</a> &raquo;</li>
          <li><a href="../index.html" >The Explorations</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Call Graphs</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pycallgraph-explorations">
<h1>PyCallGraph Explorations<a class="headerlink" href="#pycallgraph-explorations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p><em>What is the problem to solve?</em></p>
<p>While <a class="reference internal" href="explore_pyreverse.html#id1"><em>pyreverse</em></a> can be used to auto-generate class and dependency diagrams, it uses a static checker (<cite>pylint</cite>) and so is not as helpful when you want to visualize the execution of your code.</p>
<p><em>What will solve this?</em></p>
<p>I think that <a class="reference external" href="http://pycallgraph.slowchop.com/en/master/index.html">pycallgraph</a> will allow visualizing of the execution of code.</p>
<p><em>What would a correct solution look like?</em></p>
<p>If this works, an argument could be added to the ArgumentClinic to create visualizations of executing code. Additionally, for cases where the code is runnable on its own (without the ape command-line interface), call-graphs could be dynamically generated and embedded in the weaved documentation by compiling the source code (I have my doubts about this condition, running inside of Pweave seems like a bad idea). An alternative (and possibly a superior solution) would be to create a simplified command-line and just include the image in the weave.</p>
</div>
<div class="section" id="testing-the-pycallgraph">
<h2>Testing the PyCallGraph<a class="headerlink" href="#testing-the-pycallgraph" title="Permalink to this headline">¶</a></h2>
<p>Since the <tt class="docutils literal"><span class="pre">ape</span> <span class="pre">list</span></tt> sub-command does not have any external code to run I will test <tt class="docutils literal"><span class="pre">pycallgraph</span></tt> using it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># third-party</span>
<span class="kn">from</span> <span class="nn">pycallgraph</span> <span class="kn">import</span> <span class="n">PyCallGraph</span>
<span class="kn">from</span> <span class="nn">pycallgraph</span> <span class="kn">import</span> <span class="n">GlobbingFilter</span>
<span class="kn">from</span> <span class="nn">pycallgraph</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">pycallgraph.output</span> <span class="kn">import</span> <span class="n">GraphvizOutput</span>

<span class="c"># this package</span>
<span class="kn">from</span> <span class="nn">ape.interface.ubootkommandant</span> <span class="kn">import</span> <span class="n">UbootKommandant</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">subcommand</span> <span class="o">=</span> <span class="n">UbootKommandant</span><span class="p">()</span>
<span class="n">graphviz</span> <span class="o">=</span> <span class="n">GraphvizOutput</span><span class="p">()</span>
<span class="n">graphviz</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;figures/callgraphtest.png&#39;</span>
<span class="k">with</span> <span class="n">PyCallGraph</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">graphviz</span><span class="p">):</span>
   <span class="n">subcommand</span><span class="o">.</span><span class="n">list_plugins</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ape</span>
<span class="n">CrashTestDummy</span>
<span class="n">Dummy</span>
</pre></div>
</div>
<img alt="../../../../_images/callgraphtest.png" src="../../../../_images/callgraphtest.png" />
<p>That was surprisingly easy.</p>
</div>
<div class="section" id="filtering">
<h2>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h2>
<p>Although it is easy enough to follow the graph, I think that trimming some of the leaves would make it easier.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">trace_filter</span> <span class="o">=</span> <span class="n">GlobbingFilter</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="s">&#39;*interface.arguments*&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">graphviz</span> <span class="o">=</span> <span class="n">GraphvizOutput</span><span class="p">()</span>
<span class="n">graphviz</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;figures/filtered_graph.png&#39;</span>
<span class="k">with</span> <span class="n">PyCallGraph</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">graphviz</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">):</span>
   <span class="n">subcommand</span><span class="o">.</span><span class="n">list_plugins</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ape</span>
<span class="n">CrashTestDummy</span>
<span class="n">Dummy</span>
</pre></div>
</div>
<img alt="../../../../_images/filtered_graph.png" src="../../../../_images/filtered_graph.png" />
<p>That made it much clearer but wasn&#8217;t what I was expecting.</p>
<blockquote>
<div><ul class="simple">
<li><cite>pycallgraph</cite> included itself</li>
<li>More than just the <cite>arguments</cite> module was excluded</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="depth">
<h2>Depth<a class="headerlink" href="#depth" title="Permalink to this headline">¶</a></h2>
<p>Instead of filtering you can set the maximum depth that the tree will follow.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">DEPTH</span><span class="p">)</span>
<span class="n">graphviz</span> <span class="o">=</span> <span class="n">GraphvizOutput</span><span class="p">()</span>
<span class="n">graphviz</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;figures/trimmed_graph.png&#39;</span>
<span class="k">with</span> <span class="n">PyCallGraph</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">graphviz</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">):</span>
   <span class="n">subcommand</span><span class="o">.</span><span class="n">list_plugins</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ape</span>
<span class="n">CrashTestDummy</span>
<span class="n">Dummy</span>
</pre></div>
</div>
<img alt="../../../../_images/trimmed_graph.png" src="../../../../_images/trimmed_graph.png" />
<p>This seems to be the most comprehensible version (although I don&#8217;t know how the actual depth-value works &#8211; except for <tt class="docutils literal"><span class="pre">max_depth=1</span></tt> all the values seem to create the same graph).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PyCallGraph Explorations</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#testing-the-pycallgraph">Testing the PyCallGraph</a></li>
<li><a class="reference internal" href="#filtering">Filtering</a></li>
<li><a class="reference internal" href="#depth">Depth</a></li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../user/index.html">User Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../log_setter.html">Log Setter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../main.html">The Main Entry Point</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../readme.html">The APE (Read Me)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/index.html">The Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../infrastructure/index.html">The Ape&#8217;s Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../parts/index.html">Parts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../plugins/index.html">Plugins</a></li>
</ul>


<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, the cloistered monkey.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.2.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.6.2</a>
      
      |
      <a href="../../../../_sources/documentation/developer/explorations/explore_graphs/explore_pycallgraph.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>